{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "width": 600, "height": 220, "padding": 5,
  "data": [
    {
      "name": "raw",
      "url": {
        "%context%": true,
        "%timefield%": "@timestamp",
        "index": "wazuh-explain-v1",
        "body": {
          "size": 1,
          "query": { "bool": { "filter": [ { "match_all": {} } ] } },
          "_source": ["decisive_events"]
        }
      },
      "format": {"property":"hits.hits[0]._source.decisive_events"}
    }
  ],
  "marks": [
    {
      "type": "group",
      "encode": { "enter": { "width": { "value": 600 }, "height": { "value": 220 } } },
      "marks": [
        { "type": "rect", "encode": { "enter": { "x": {"value":0}, "y": {"value":0}, "width":{"value":600}, "height":{"value":24}, "fill":{"value":"#f3f4f6"} } } },
        { "type": "text", "encode": { "enter": { "x":{"value":8}, "y":{"value":16}, "text":{"value":"Time"}, "baseline":{"value":"middle"}, "fontWeight":{"value":"bold"} } } },
        { "type": "text", "encode": { "enter": { "x":{"value":160}, "y":{"value":16}, "text":{"value":"Type"}, "baseline":{"value":"middle"}, "fontWeight":{"value":"bold"} } } },
        { "type": "text", "encode": { "enter": { "x":{"value":300}, "y":{"value":16}, "text":{"value":"Snippet"}, "baseline":{"value":"middle"}, "fontWeight":{"value":"bold"} } } },
        {
          "type": "text",
          "from": {"data":"raw"},
          "encode": {
            "enter": {
              "x":{"value":8},
              "y":{"signal":"index()*22 + 44"},
              "text":{"signal":"isValid(datum.ts) ? timeFormat(toDate(datum.ts), '%Y-%m-%d %H:%M:%S') : ''"},
              "baseline":{"value":"middle"}
            }
          }
        },
        {
          "type": "text",
          "from": {"data":"raw"},
          "encode": {
            "enter": {
              "x":{"value":160},
              "y":{"signal":"index()*22 + 44"},
              "text":{"field":"type"},
              "baseline":{"value":"middle"}
            }
          }
        },
        {
          "type": "text",
          "from": {"data":"raw"},
          "encode": {
            "enter": {
              "x":{"value":300},
              "y":{"signal":"index()*22 + 44"},
              "text":{"signal":"slice(datum.snippet,0,60)"},
              "baseline":{"value":"middle"}
            }
          }
        }
      ]
    }
  ]
}
